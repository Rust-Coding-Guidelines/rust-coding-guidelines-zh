<!DOCTYPE HTML>
<html lang="zh" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>注释 - RustCodingGuidelines</title>
        
        


        <!-- Custom HTML head -->
        


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        
        <link rel="icon" href="../../favicon.svg">
        
        
        <link rel="shortcut icon" href="../../favicon.png">
        
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        
        <link rel="stylesheet" href="../../css/print.css" media="print">
        

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        
        <link rel="stylesheet" href="../../fonts/fonts.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item affix "><li class="part-title">介绍</li><li class="chapter-item "><a href="../../index.html"><strong aria-hidden="true">1.</strong> Rust 编码规范介绍</a></li><li class="chapter-item "><a href="../../contribution.html"><strong aria-hidden="true">2.</strong> 贡献说明</a></li><li class="chapter-item affix "><li class="part-title">安全编码规范</li><li class="chapter-item "><a href="../../safe-guides/intro.html"><strong aria-hidden="true">3.</strong> 前言</a></li><li class="chapter-item "><a href="../../safe-guides/dev_env.html"><strong aria-hidden="true">4.</strong> 开发环境</a></li><li class="chapter-item expanded "><a href="../../safe-guides/code_style.html"><strong aria-hidden="true">5.</strong> 代码风格</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../safe-guides/code_style/naming.html"><strong aria-hidden="true">5.1.</strong> 命名</a></li><li class="chapter-item "><a href="../../safe-guides/code_style/fmt.html"><strong aria-hidden="true">5.2.</strong> 格式</a></li><li class="chapter-item expanded "><a href="../../safe-guides/code_style/comments.html" class="active"><strong aria-hidden="true">5.3.</strong> 注释</a></li></ol></li><li class="chapter-item "><a href="../../safe-guides/coding_practice.html"><strong aria-hidden="true">6.</strong> 编程实践</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../safe-guides/coding_practice/consts.html"><strong aria-hidden="true">6.1.</strong> 常量</a></li><li class="chapter-item "><a href="../../safe-guides/coding_practice/statics.html"><strong aria-hidden="true">6.2.</strong> 静态变量</a></li><li class="chapter-item "><a href="../../safe-guides/coding_practice/variables.html"><strong aria-hidden="true">6.3.</strong> 本地变量</a></li><li class="chapter-item "><a href="../../safe-guides/coding_practice/data-type.html"><strong aria-hidden="true">6.4.</strong> 数据类型</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../safe-guides/coding_practice/data-type/unit.html"><strong aria-hidden="true">6.4.1.</strong> 单元类型</a></li><li class="chapter-item "><a href="../../safe-guides/coding_practice/data-type/bool.html"><strong aria-hidden="true">6.4.2.</strong> 布尔</a></li><li class="chapter-item "><a href="../../safe-guides/coding_practice/data-type/char.html"><strong aria-hidden="true">6.4.3.</strong> 字符</a></li><li class="chapter-item "><a href="../../safe-guides/coding_practice/data-type/int.html"><strong aria-hidden="true">6.4.4.</strong> 整数</a></li><li class="chapter-item "><a href="../../safe-guides/coding_practice/data-type/float.html"><strong aria-hidden="true">6.4.5.</strong> 浮点数</a></li><li class="chapter-item "><a href="../../safe-guides/coding_practice/data-type/slice-and_str.html"><strong aria-hidden="true">6.4.6.</strong> 切片</a></li><li class="chapter-item "><a href="../../safe-guides/coding_practice/data-type/tuple.html"><strong aria-hidden="true">6.4.7.</strong> 元组</a></li><li class="chapter-item "><a href="../../safe-guides/coding_practice/data-type/array.html"><strong aria-hidden="true">6.4.8.</strong> 数组</a></li><li class="chapter-item "><a href="../../safe-guides/coding_practice/data-type/struct.html"><strong aria-hidden="true">6.4.9.</strong> 结构体</a></li><li class="chapter-item "><a href="../../safe-guides/coding_practice/data-type/enum.html"><strong aria-hidden="true">6.4.10.</strong> 枚举体</a></li></ol></li><li class="chapter-item "><a href="../../safe-guides/coding_practice/expr.html"><strong aria-hidden="true">6.5.</strong> 表达式</a></li><li class="chapter-item "><a href="../../safe-guides/coding_practice/control-flow.html"><strong aria-hidden="true">6.6.</strong> 流程控制</a></li><li class="chapter-item "><a href="../../safe-guides/coding_practice/strings.html"><strong aria-hidden="true">6.7.</strong> 字符串</a></li><li class="chapter-item "><a href="../../safe-guides/coding_practice/collections.html"><strong aria-hidden="true">6.8.</strong> 集合容器</a></li><li class="chapter-item "><a href="../../safe-guides/coding_practice/fn-and-closure.html"><strong aria-hidden="true">6.9.</strong> 函数与闭包</a></li><li class="chapter-item "><a href="../../safe-guides/coding_practice/generic.html"><strong aria-hidden="true">6.10.</strong> 泛型</a></li><li class="chapter-item "><a href="../../safe-guides/coding_practice/traits.html"><strong aria-hidden="true">6.11.</strong> 特质</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../safe-guides/coding_practice/traits/std-buildin.html"><strong aria-hidden="true">6.11.1.</strong> 标准库内置 trait</a></li><li class="chapter-item "><a href="../../safe-guides/coding_practice/traits/trait-object.html"><strong aria-hidden="true">6.11.2.</strong> trait 对象</a></li></ol></li><li class="chapter-item "><a href="../../safe-guides/coding_practice/error-handle.html"><strong aria-hidden="true">6.12.</strong> 错误处理</a></li><li class="chapter-item "><a href="../../safe-guides/coding_practice/memory.html"><strong aria-hidden="true">6.13.</strong> 内存管理</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../safe-guides/coding_practice/memory/lifetime.html"><strong aria-hidden="true">6.13.1.</strong> 生存期</a></li><li class="chapter-item "><a href="../../safe-guides/coding_practice/memory/box.html"><strong aria-hidden="true">6.13.2.</strong> Box&lt;T&gt;</a></li><li class="chapter-item "><a href="../../safe-guides/coding_practice/memory/drop.html"><strong aria-hidden="true">6.13.3.</strong> Drop 析构</a></li></ol></li><li class="chapter-item "><a href="../../safe-guides/coding_practice/module.html"><strong aria-hidden="true">6.14.</strong> 模块</a></li><li class="chapter-item "><a href="../../safe-guides/coding_practice/cargo.html"><strong aria-hidden="true">6.15.</strong> 包管理</a></li><li class="chapter-item "><a href="../../safe-guides/coding_practice/macros.html"><strong aria-hidden="true">6.16.</strong> 宏</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../safe-guides/coding_practice/macros/declarative.html"><strong aria-hidden="true">6.16.1.</strong> 声明宏</a></li><li class="chapter-item "><a href="../../safe-guides/coding_practice/macros/Procedural.html"><strong aria-hidden="true">6.16.2.</strong> 过程宏</a></li></ol></li><li class="chapter-item "><a href="../../safe-guides/coding_practice/threads.html"><strong aria-hidden="true">6.17.</strong> 多线程</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../safe-guides/coding_practice/threads/lock.html"><strong aria-hidden="true">6.17.1.</strong> 有锁</a></li><li class="chapter-item "><a href="../../safe-guides/coding_practice/threads/lock-free.html"><strong aria-hidden="true">6.17.2.</strong> 无锁</a></li></ol></li><li class="chapter-item "><a href="../../safe-guides/coding_practice/async-await.html"><strong aria-hidden="true">6.18.</strong> 异步编程</a></li><li class="chapter-item "><a href="../../safe-guides/coding_practice/unsafe_rust.html"><strong aria-hidden="true">6.19.</strong> Unsafe Rust</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../safe-guides/coding_practice/unsafe_rust/safe_abstract.html"><strong aria-hidden="true">6.19.1.</strong> 安全抽象</a></li><li class="chapter-item "><a href="../../safe-guides/coding_practice/unsafe_rust/raw_ptr.html"><strong aria-hidden="true">6.19.2.</strong> 裸指针操作</a></li><li class="chapter-item "><a href="../../safe-guides/coding_practice/unsafe_rust/union.html"><strong aria-hidden="true">6.19.3.</strong> 联合体</a></li><li class="chapter-item "><a href="../../safe-guides/coding_practice/unsafe_rust/layout.html"><strong aria-hidden="true">6.19.4.</strong> 内存布局</a></li><li class="chapter-item "><a href="../../safe-guides/coding_practice/unsafe_rust/ffi.html"><strong aria-hidden="true">6.19.5.</strong> FFi 规范</a></li></ol></li><li class="chapter-item "><a href="../../safe-guides/coding_practice/others.html"><strong aria-hidden="true">6.20.</strong> 其他</a></li></ol></li><li class="chapter-item "><a href="../../safe-guides/Appendix/toc.html"><strong aria-hidden="true">7.</strong> 附录</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../safe-guides/Appendix/test.html"><strong aria-hidden="true">7.1.</strong> 测试</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../safe-guides/Appendix/test/unit_test.html"><strong aria-hidden="true">7.1.1.</strong> 单元测试</a></li><li class="chapter-item "><a href="../../safe-guides/Appendix/test/benchmark.html"><strong aria-hidden="true">7.1.2.</strong> 基准测试</a></li><li class="chapter-item "><a href="../../safe-guides/Appendix/test/fuzz.html"><strong aria-hidden="true">7.1.3.</strong> 模糊测试</a></li></ol></li><li class="chapter-item "><a href="../../safe-guides/Appendix/terms.html"><strong aria-hidden="true">7.2.</strong> 术语解释</a></li></ol></li><li class="chapter-item "><li class="part-title">领域最佳实践</li><li class="chapter-item "><a href="../../best-practices/intro.html"><strong aria-hidden="true">8.</strong> 介绍</a></li><li class="chapter-item "><a href="../../best-practices/embedded.html"><strong aria-hidden="true">9.</strong> 嵌入式 Rust</a></li><li class="chapter-item "><a href="../../best-practices/databases.html"><strong aria-hidden="true">10.</strong> 数据库</a></li><li class="chapter-item "><a href="../../best-practices/games.html"><strong aria-hidden="true">11.</strong> 游戏</a></li><li class="chapter-item "><a href="../../best-practices/cli_app.html"><strong aria-hidden="true">12.</strong> Cli App</a></li><li class="chapter-item "><a href="../../best-practices/gui.html"><strong aria-hidden="true">13.</strong> GUI</a></li><li class="chapter-item "><a href="../../best-practices/web.html"><strong aria-hidden="true">14.</strong> Web 开发</a></li><li class="chapter-item "><a href="../../best-practices/networks.html"><strong aria-hidden="true">15.</strong> 网络服务</a></li><li class="chapter-item "><a href="../../best-practices/webassembly.html"><strong aria-hidden="true">16.</strong> WebAssembly</a></li><li class="chapter-item affix "><li class="part-title">工具链使用指南</li><li class="chapter-item "><a href="../../tools/intro.html"><strong aria-hidden="true">17.</strong> 介绍</a></li><li class="chapter-item "><a href="../../tools/rustfmt.html"><strong aria-hidden="true">18.</strong> Rustfmt 配置相关说明</a></li><li class="chapter-item affix "><li class="part-title">Rust 优化指南</li><li class="chapter-item "><a href="../../optimizing/intro.html"><strong aria-hidden="true">19.</strong> 介绍</a></li><li class="chapter-item affix "><li class="part-title">Rust 常用基础库指南</li><li class="chapter-item "><a href="../../libs/intro.html"><strong aria-hidden="true">20.</strong> 介绍</a></li><li class="chapter-item "><a href="../../libs/serde.html"><strong aria-hidden="true">21.</strong> serde</a></li><li class="chapter-item "><a href="../../libs/clap-structopt.html"><strong aria-hidden="true">22.</strong> clap/structopt</a></li><li class="chapter-item "><a href="../../libs/nom.html"><strong aria-hidden="true">23.</strong> nom</a></li><li class="chapter-item "><a href="../../libs/rand.html"><strong aria-hidden="true">24.</strong> rand</a></li><li class="chapter-item "><a href="../../libs/ring.html"><strong aria-hidden="true">25.</strong> ring</a></li><li class="chapter-item "><a href="../../libs/regex.html"><strong aria-hidden="true">26.</strong> regex</a></li><li class="chapter-item "><a href="../../libs/syn-quote.html"><strong aria-hidden="true">27.</strong> syn/quote</a></li><li class="chapter-item "><a href="../../libs/chrono.html"><strong aria-hidden="true">28.</strong> chrono</a></li><li class="chapter-item "><a href="../../libs/crossbeam.html"><strong aria-hidden="true">29.</strong> crossbeam</a></li><li class="chapter-item "><a href="../../libs/parking_lot.html"><strong aria-hidden="true">30.</strong> parking_lot</a></li><li class="chapter-item "><a href="../../libs/rayon.html"><strong aria-hidden="true">31.</strong> rayon</a></li><li class="chapter-item "><a href="../../libs/wasm-bindgen.html"><strong aria-hidden="true">32.</strong> wasm-bindgen</a></li><li class="chapter-item "><a href="../../libs/bindgen.html"><strong aria-hidden="true">33.</strong> bindgen</a></li><li class="chapter-item "><a href="../../libs/cbindgen.html"><strong aria-hidden="true">34.</strong> cbindgen</a></li><li class="chapter-item "><a href="../../libs/cxx.html"><strong aria-hidden="true">35.</strong> cxx</a></li><li class="chapter-item "><a href="../../libs/tokio.html"><strong aria-hidden="true">36.</strong> tokio</a></li><li class="chapter-item "><a href="../../libs/hyper.html"><strong aria-hidden="true">37.</strong> hyper</a></li><li class="chapter-item "><a href="../../libs/async-std.html"><strong aria-hidden="true">38.</strong> async-std</a></li><li class="chapter-item "><a href="../../libs/rocket.html"><strong aria-hidden="true">39.</strong> rocket</a></li><li class="chapter-item "><a href="../../libs/actix-web.html"><strong aria-hidden="true">40.</strong> actix-web</a></li><li class="chapter-item "><a href="../../libs/tui.html"><strong aria-hidden="true">41.</strong> tui-rs</a></li><li class="chapter-item "><a href="../../libs/criterion.html"><strong aria-hidden="true">42.</strong> criterion</a></li><li class="chapter-item "><a href="../../libs/embedded-hal.html"><strong aria-hidden="true">43.</strong> embedded-hal</a></li><li class="chapter-item "><a href="../../libs/knurling-tools.html"><strong aria-hidden="true">44.</strong> knurling-tools</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">RustCodingGuidelines</h1>

                    <div class="right-buttons">
                        
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                        
                        <a href="https://github.com/Rust-Coding-Guidelines/rust-coding-guidelines-zh" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1><a class="header" href="#注释与文档" id="注释与文档">注释与文档</a></h1>
<p>在 Rust 中，注释分为两类：普通注释和文档注释。普通注释使用 <code>//</code> 或 <code>/* ... */</code>，文档注释使用 <code>///</code>、<code>//!</code> 或 <code>/** ... **/</code>。</p>
<p>在原则和规则中提到「注释」时，包括普通注释和文档注释。当提到「文档」时，特指文档注释。</p>
<hr />
<h2><a class="header" href="#pcmt01-不到必要的时候不要添加注释" id="pcmt01-不到必要的时候不要添加注释">P.CMT.01 不到必要的时候不要添加注释</a></h2>
<h3><a class="header" href="#描述" id="描述">【描述】</a></h3>
<p>注释固然很重要, 但最好的代码应当本身就是文档。有意义的类型名、函数名和变量名, 要远胜过要用注释解释的含糊不清的名字。当有意义的类型名、函数名和变量名还不能表达完整的语义时，再使用注释。</p>
<p>不要描述显而易见的现象, 永远不要用自然语言翻译代码作为注释。</p>
<h2><a class="header" href="#pcmt02-文档应该始终基于-rustdoc-工具来构建" id="pcmt02-文档应该始终基于-rustdoc-工具来构建">P.CMT.02 文档应该始终基于 <code>rustdoc</code> 工具来构建</a></h2>
<h3><a class="header" href="#描述-1" id="描述-1">【描述】</a></h3>
<p>Rust 语言提供 <code>rustdoc</code> 工具来帮助构建文档，所以应该始终围绕<code>rustdoc</code>工具的特性来构建项目文档。</p>
<h2><a class="header" href="#pcmt03-文档应该围绕-what-和-how-为核心来构建" id="pcmt03-文档应该围绕-what-和-how-为核心来构建">P.CMT.03 文档应该围绕 What 和 How 为核心来构建</a></h2>
<h3><a class="header" href="#描述-2" id="描述-2">【描述】</a></h3>
<p>文档应该始终围绕两个方向来构建：</p>
<ol>
<li>What : 用于阐述代码为什么而构建。</li>
<li>how : 用于阐述代码如何去使用。</li>
</ol>
<h2><a class="header" href="#pcmt04-注释和文档应该保持简短精干" id="pcmt04-注释和文档应该保持简短精干">P.CMT.04 注释和文档应该保持简短精干</a></h2>
<h3><a class="header" href="#描述-3" id="描述-3">【描述】</a></h3>
<ol>
<li>文档内容用语应该尽量简短精干，不宜篇幅过长。请确保你的代码注释良好并且易于他人理解。</li>
<li>使用通俗易懂的描述而尽量避免使用专业技术术语。好的注释能够传达上下文关系和代码目的。</li>
</ol>
<h2><a class="header" href="#pcmt05-注释和文档使用的自然语言要保持一致" id="pcmt05-注释和文档使用的自然语言要保持一致">P.CMT.05 注释和文档使用的自然语言要保持一致</a></h2>
<h3><a class="header" href="#描述-4" id="描述-4">【描述】</a></h3>
<p>注释和文档尽量使用英文来填写，如果要使用中文，整个项目必须都使用中文。请确保整个项目中文档和注释都使用同一种文本语言，保持一致性。</p>
<h2><a class="header" href="#pcmt06-在文档中应该使用-markdown-格式" id="pcmt06-在文档中应该使用-markdown-格式">P.CMT.06 在文档中应该使用 Markdown 格式</a></h2>
<h3><a class="header" href="#描述-5" id="描述-5">【描述】</a></h3>
<p>Rust 文档注释支持 Markdown ，所以在编写文档注释的时候，应该使用 Markdown 格式。</p>
<h3><a class="header" href="#示例" id="示例">【示例】</a></h3>
<p>模块级文档，来自于 Rust 标准库<code>std::vec</code>：</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>//! # The Rust core allocation and collections library
//!
//! This library provides smart pointers and collections for managing
//! heap-allocated values.
//!
//! This library, like libcore, normally doesn’t need to be used directly
//! since its contents are re-exported in the [`std` crate](../std/index.html).
//! Crates that use the `#![no_std]` attribute however will typically
//! not depend on `std`, so they’d use this crate instead.
//!
//! ## Boxed values
//!
//! The [`Box`] type is a smart pointer type. There can only be one owner of a
//! [`Box`], and the owner can decide to mutate the contents, which live on the
//! heap.
<span class="boring">}
</span></code></pre></pre>
<p>普通文档注释示例，来自标准库<code>Vec::new</code>方法：</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>    /// Constructs a new, empty `Vec&lt;T&gt;`.
    ///
    /// The vector will not allocate until elements are pushed onto it.
    ///
    /// # Examples
    ///
    /// ```
    /// # #![allow(unused_mut)]
    /// let mut vec: Vec&lt;i32&gt; = Vec::new();
    /// ```
    #[inline]
    #[rustc_const_stable(feature = &quot;const_vec_new&quot;, since = &quot;1.39.0&quot;)]
    #[stable(feature = &quot;rust1&quot;, since = &quot;1.0.0&quot;)]
    pub const fn new() -&gt; Self {
        Vec { buf: RawVec::NEW, len: 0 }
    }
<span class="boring">}
</span></code></pre></pre>
<hr />
<h2><a class="header" href="#gcmt01-注释应该有一定宽度限制" id="gcmt01-注释应该有一定宽度限制">G.CMT.01 注释应该有一定宽度限制</a></h2>
<h3><a class="header" href="#级别建议" id="级别建议">【级别：建议】</a></h3>
<p>建议按此规范执行。</p>
<h3><a class="header" href="#rustfmt-配置" id="rustfmt-配置">【rustfmt 配置】</a></h3>
<p>此规则 Clippy 不可检测，由 rustfmt 自动格式化。</p>
<p>rustfmt 配置：</p>
<table><thead><tr><th>对应选项</th><th>可选值</th><th>是否 stable</th><th>说明</th></tr></thead><tbody>
<tr><td><a href="https://rust-lang.github.io/rustfmt/?#comment_width"><code>comment_width</code></a></td><td>80（默认）</td><td>No</td><td>指定一行注释允许的最大宽度</td></tr>
<tr><td><a href="https://rust-lang.github.io/rustfmt/?#wrap_comments"><code>wrap_comments</code></a></td><td>false（默认），true（建议）</td><td>No</td><td>指定一行注释允许的最大宽度</td></tr>
</tbody></table>
<h3><a class="header" href="#描述-6" id="描述-6">【描述】</a></h3>
<p>每行注释的宽度不能过长，需要设置一定的宽度，有助于提升可读性。<code>comment_width</code>可配合 <code>wrap_comments</code> 将超过宽度限制的注释自动分割为多行。</p>
<p>注意：<code>use_small_heuristics</code>配置项并不包括<code>comment_width</code>。</p>
<h3><a class="header" href="#示例-1" id="示例-1">【示例】</a></h3>
<p>【正例】</p>
<p>当 <code>comment_width=80</code> 且 <code>wrap_comments=true</code>时。</p>
<p>注意：这里 <code>wrap_comments</code>并未使用默认值，需要配置为 true。</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// Lorem ipsum dolor sit amet, consectetur adipiscing elit,
// sed do eiusmod tempor incididunt ut labore et dolore
// magna aliqua. Ut enim ad minim veniam, quis nostrud
// exercitation ullamco laboris nisi ut aliquip ex ea
// commodo consequat.
<span class="boring">}
</span></code></pre></pre>
<p>【反例】</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.
<span class="boring">}
</span></code></pre></pre>
<h2><a class="header" href="#gcmt02-使用行注释而避免使用块注释" id="gcmt02-使用行注释而避免使用块注释">G.CMT.02 使用行注释而避免使用块注释</a></h2>
<h3><a class="header" href="#级别建议-1" id="级别建议-1">【级别：建议】</a></h3>
<p>建议按此规范执行。</p>
<h3><a class="header" href="#rustfmt-配置-1" id="rustfmt-配置-1">【rustfmt 配置】</a></h3>
<p>此规则 Clippy 不可检测，由 rustfmt 自动格式化。</p>
<p>rustfmt 配置：</p>
<table><thead><tr><th>对应选项</th><th>可选值</th><th>是否 stable</th><th>说明</th></tr></thead><tbody>
<tr><td><a href="https://rust-lang.github.io/rustfmt/?#normalize_comments"><code>normalize_comments</code></a></td><td>false（默认）</td><td>No</td><td>将 <code>/**/</code> 注释转为 <code>//</code></td></tr>
<tr><td><a href="https://rust-lang.github.io/rustfmt/?#normalize_doc_attributes"><code>normalize_doc_attributes</code></a></td><td>false（默认）</td><td>No</td><td>将 <code>#![doc]</code> 和 <code>#[doc]</code> 注释转为 <code>//!</code> 和 <code>///</code></td></tr>
</tbody></table>
<h3><a class="header" href="#描述-7" id="描述-7">【描述】</a></h3>
<p>尽量使用行注释（<code>//</code> 或 <code>///</code>），而非块注释。</p>
<p>对于文档注释，仅在编写模块级文档时使用 <code>//!</code>，在其他情况使用 <code>///</code>更好。</p>
<h3><a class="header" href="#示例-2" id="示例-2">【示例】</a></h3>
<p>【正例】</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// Wait for the main task to return, and set the process error code
// appropriately.

// 在使用 `mod` 关键字定义模块时，在 `mod`之上使用 `///` 更好。
/// This module contains tests
mod tests {
    // ...
}

//! Example documentation

/// Example item documentation
pub enum Foo {}

<span class="boring">}
</span></code></pre></pre>
<p>【反例】</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>/*
 * Wait for the main task to return, and set the process error code
 * appropriately.
 */

mod tests {
    //! This module contains tests

    // ...
}

#![doc = &quot;Example documentation&quot;]

#[doc = &quot;Example item documentation&quot;]
pub enum Foo {}
<span class="boring">}
</span></code></pre></pre>
<h2><a class="header" href="#gcmt03-在每一个文件开头加入版权公告" id="gcmt03-在每一个文件开头加入版权公告">G.CMT.03 在每一个文件开头加入版权公告</a></h2>
<h3><a class="header" href="#级别建议-2" id="级别建议-2">【级别：建议】</a></h3>
<p>建议按此规范执行。</p>
<h3><a class="header" href="#rustfmt-配置-2" id="rustfmt-配置-2">【rustfmt 配置】</a></h3>
<p>此规则 Clippy 不可检测，由 rustfmt 自动格式化。</p>
<p>rustfmt 配置：</p>
<table><thead><tr><th>对应选项</th><th>可选值</th><th>是否 stable</th><th>说明</th></tr></thead><tbody>
<tr><td><a href="https://rust-lang.github.io/rustfmt/?#license_template_path"><code>license_template_path</code></a></td><td>格式化每一个Rust文件（默认）</td><td>No</td><td>指定许可证模版路径</td></tr>
</tbody></table>
<h3><a class="header" href="#描述-8" id="描述-8">【描述】</a></h3>
<p>每个文件都应该包含许可证引用。为项目选择合适的许可证版本.(比如, Apache 2.0, BSD, LGPL, GPL)。</p>
<p>可以通过 <code>rustfmt</code> 的 <code>license_template_path</code> 配置项 和 <code>license.template</code>来自动化此操作。</p>
<h3><a class="header" href="#示例-3" id="示例-3">【示例】</a></h3>
<p>【正例】</p>
<p>来自 <a href="https://github.com/tikv/tikv/blob/master/etc/license.template">TiKV</a> 项目的案例。可以命名为<code>.rustfmt.license-template</code>许可证模版。</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// Copyright {\d+} TiKV Project Authors. Licensed under Apache-2.0.
<span class="boring">}
</span></code></pre></pre>
<p>在 <code>rustfmt.toml</code> 中配置：</p>
<pre><code class="language-toml">license_template_path = &quot;.rustfmt.license-template&quot;
</code></pre>
<p>在代码文件中手工添加对应的注释 （自动插入功能还未支持）：</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// Copyright 2021 TiKV Project Authors. Licensed under Apache-2.0.
<span class="boring">}
</span></code></pre></pre>
<h2><a class="header" href="#gcmt04-在注释中使用-fixme-和-todo-来帮助任务协作" id="gcmt04-在注释中使用-fixme-和-todo-来帮助任务协作">G.CMT.04 在注释中使用 <code>FIXME</code> 和 <code>TODO</code> 来帮助任务协作</a></h2>
<h3><a class="header" href="#级别建议-3" id="级别建议-3">【级别：建议】</a></h3>
<p>建议按此规范执行。</p>
<h3><a class="header" href="#rustfmt-配置-3" id="rustfmt-配置-3">【rustfmt 配置】</a></h3>
<p>此规则 Clippy 不可检测，由 rustfmt 自动格式化。</p>
<p>rustfmt 配置：</p>
<table><thead><tr><th>对应选项</th><th>可选值</th><th>是否 stable</th><th>说明</th></tr></thead><tbody>
<tr><td><a href="https://rust-lang.github.io/rustfmt/?#report_fixme"><code>report_fixme</code></a></td><td>Never（默认），Unnumbered（推荐）</td><td>No</td><td>是否报告 FIXME 注释</td></tr>
<tr><td><a href="https://rust-lang.github.io/rustfmt/?#report_todo"><code>report_todo</code></a></td><td>Never（默认），Unnumbered（推荐）</td><td>No</td><td>是否报告 FIXME 注释</td></tr>
</tbody></table>
<h3><a class="header" href="#描述-9" id="描述-9">【描述】</a></h3>
<p>通过在注释中开启 <code>FIXME</code> 和 <code>TODO</code> 可以方便协作。rustfmt 默认不开启该项，所以需要配置。</p>
<p>但是配置为 <code>Always</code> 没必要，只需要配置为 <code>Unnumbered</code> 针对编号的 <code>FXIME</code> 和 <code>TODO</code> 报告即可。</p>
<p>这两个配置目前有 Bug ，无法正确识别报告，但不影响这个规则的应用。</p>
<h3><a class="header" href="#示例-4" id="示例-4">【示例】</a></h3>
<p>【正例】</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span>
<span class="boring">fn main() {
</span>// TODO(calebcartwright): consider enabling box_patterns feature gate
fn annotation_type_for_level(level: Level) -&gt; AnnotationType {
    match level {
        Level::Bug | Level::Fatal | Level::Error =&gt; AnnotationType::Error,
        Level::Warning =&gt; AnnotationType::Warning,
        Level::Note =&gt; AnnotationType::Note,
        Level::Help =&gt; AnnotationType::Help,
        // FIXME(#59346): Not sure how to map these two levels
        Level::Cancelled | Level::FailureNote =&gt; AnnotationType::Error,
        Level::Allow =&gt; panic!(&quot;Should not call with Allow&quot;),
    }
}
<span class="boring">}
</span></code></pre></pre>
<h2><a class="header" href="#gcmt05-在-公开的-unsafe-函数的文档中必须增加--safety-注释" id="gcmt05-在-公开的-unsafe-函数的文档中必须增加--safety-注释">G.CMT.05 在 公开的 unsafe 函数的文档中必须增加 <code># Safety</code> 注释</a></h2>
<h3><a class="header" href="#级别必须" id="级别必须">【级别：必须】</a></h3>
<p>必须按此规范执行。</p>
<h3><a class="header" href="#lint-检测" id="lint-检测">【Lint 检测】</a></h3>
<table><thead><tr><th>lint name</th><th>Clippy 可检测</th><th>Rustc 可检测</th><th>Lint Group</th><th>默认 level</th></tr></thead><tbody>
<tr><td><a href="https://rust-lang.github.io/rust-clippy/master/index.html#missing_safety_doc">missing_safety_doc</a></td><td>yes</td><td>no</td><td>Style</td><td>warn</td></tr>
</tbody></table>
<h3><a class="header" href="#描述-10" id="描述-10">【描述】</a></h3>
<p>在公开（pub）的 unsafe 函数文档中，必须增加 <code># Safety</code> 注释来解释该函数的安全边界，这样使用该函数的用户才可以安全地使用它。</p>
<p>说明： 该规则通过 cargo clippy 来检测。默认会发出警告。</p>
<h3><a class="header" href="#示例-5" id="示例-5">【示例】</a></h3>
<p>【正例】</p>
<p>示例来自于标准库文档： <a href="https://doc.rust-lang.org/stable/src/alloc/vec/mod.rs.html#1167">https://doc.rust-lang.org/stable/src/alloc/vec/mod.rs.html#1167</a></p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>    /// Creates a `Vec&lt;T&gt;` directly from the raw components of another vector.
    ///
    /// # Safety
    ///
    /// This is highly unsafe, due to the number of invariants that aren't
    /// checked:
    ///
    /// * `ptr` needs to have been previously allocated via [`String`]/`Vec&lt;T&gt;`
    ///   (at least, it's highly likely to be incorrect if it wasn't).
    /// * `T` needs to have the same size and alignment as what `ptr` was allocated with.
    ///   (`T` having a less strict alignment is not sufficient, the alignment really
    ///   needs to be equal to satisfy the [`dealloc`] requirement that memory must be
    ///   allocated and deallocated with the same layout.)
    /// * `length` needs to be less than or equal to `capacity`.
    /// * `capacity` needs to be the capacity that the pointer was allocated with.
    pub unsafe fn from_raw_parts(ptr: *mut T, length: usize, capacity: usize) -&gt; Self {
        unsafe { Self::from_raw_parts_in(ptr, length, capacity, Global) }
    }
<span class="boring">}
</span></code></pre></pre>
<p>【反例】</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>    /// Creates a `Vec&lt;T&gt;` directly from the raw components of another vector.
    pub unsafe fn from_raw_parts(ptr: *mut T, length: usize, capacity: usize) -&gt; Self {
        unsafe { Self::from_raw_parts_in(ptr, length, capacity, Global) }
    }
<span class="boring">}
</span></code></pre></pre>
<h2><a class="header" href="#gcmt06-在-公开的返回result类型返回的函数文档中增加--error-注释" id="gcmt06-在-公开的返回result类型返回的函数文档中增加--error-注释">G.CMT.06 在 公开的返回<code>Result</code>类型返回的函数文档中增加 <code># Error</code> 注释</a></h2>
<h3><a class="header" href="#级别建议-4" id="级别建议-4">【级别：建议】</a></h3>
<p>建议按此规范执行。</p>
<h3><a class="header" href="#lint-检测-1" id="lint-检测-1">【Lint 检测】</a></h3>
<table><thead><tr><th>lint name</th><th>Clippy 可检测</th><th>Rustc 可检测</th><th>Lint Group</th><th>默认 level</th></tr></thead><tbody>
<tr><td><a href="https://rust-lang.github.io/rust-clippy/master/index.html#missing_errors_doc">missing_errors_doc </a></td><td>yes</td><td>no</td><td>Style</td><td>allow</td></tr>
</tbody></table>
<h3><a class="header" href="#描述-11" id="描述-11">【描述】</a></h3>
<p>在公开（pub）的返回<code>Result</code>类型函数文档中，建议增加 <code># Error</code> 注释来解释该函数返回的错误类型，方便用户处理错误。</p>
<p>说明： 该规则通过 cargo clippy 来检测。默认不会警告。</p>
<h3><a class="header" href="#示例-6" id="示例-6">【示例】</a></h3>
<p>【正例】</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span><span class="boring">use std::io;
</span>/// # Errors
///
/// Will return `Err` if `filename` does not exist or the user does not have
/// permission to read it.
pub fn read(filename: String) -&gt; io::Result&lt;String&gt; {
    unimplemented!();
}
<span class="boring">}
</span></code></pre></pre>
<p>【反例】</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span><span class="boring">use std::io;
</span>pub fn read(filename: String) -&gt; io::Result&lt;String&gt; {
    unimplemented!();
}
<span class="boring">}
</span></code></pre></pre>
<h2><a class="header" href="#gcmt07-在-公开的函数文档中增加--panic-注释" id="gcmt07-在-公开的函数文档中增加--panic-注释">G.CMT.07 在 公开的函数文档中增加 <code># Panic</code> 注释</a></h2>
<h3><a class="header" href="#级别建议-5" id="级别建议-5">【级别：建议】</a></h3>
<p>建议按此规范执行。</p>
<h3><a class="header" href="#lint-检测-2" id="lint-检测-2">【Lint 检测】</a></h3>
<table><thead><tr><th>lint name</th><th>Clippy 可检测</th><th>Rustc 可检测</th><th>Lint Group</th><th>默认 level</th></tr></thead><tbody>
<tr><td><a href="https://rust-lang.github.io/rust-clippy/master/index.html#missing_panics_doc">missing_panics_doc </a></td><td>yes</td><td>no</td><td>Style</td><td>allow</td></tr>
</tbody></table>
<h3><a class="header" href="#描述-12" id="描述-12">【描述】</a></h3>
<p>在公开（pub）函数文档中，建议增加 <code># Panic</code> 注释来解释该函数在什么条件下会 Panic，便于使用者进行预处理。</p>
<p>说明： 该规则通过 cargo clippy 来检测。默认不会警告。</p>
<h3><a class="header" href="#示例-7" id="示例-7">【示例】</a></h3>
<p>【正例】</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>/// # Panics
///
/// Will panic if y is 0
pub fn divide_by(x: i32, y: i32) -&gt; i32 {
    if y == 0 {
        panic!(&quot;Cannot divide by 0&quot;)
    } else {
        x / y
    }
}
<span class="boring">}
</span></code></pre></pre>
<p>【反例】</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub fn divide_by(x: i32, y: i32) -&gt; i32 {
    if y == 0 {
        panic!(&quot;Cannot divide by 0&quot;)
    } else {
        x / y
    }
}
<span class="boring">}
</span></code></pre></pre>
<hr />
<h2><a class="header" href="#参考" id="参考">参考</a></h2>
<ol>
<li><a href="https://github.com/rust-lang/rfcs/blob/master/text/0505-api-comment-conventions.md">RFC 505: API 注释约定</a></li>
<li><a href="https://github.com/rust-lang/rfcs/blob/master/text/1574-more-api-documentation-conventions.md">RFC 1574: API 文档约定</a></li>
<li><a href="https://www.tangramvision.com/blog/making-great-docs-with-rustdoc">Making Great Docs with Rustdoc</a></li>
<li><a href="https://doc.rust-lang.org/rustdoc/what-is-rustdoc.html">Rust Doc book</a></li>
</ol>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="../../safe-guides/code_style/fmt.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="../../safe-guides/coding_practice.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a rel="prev" href="../../safe-guides/code_style/fmt.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a rel="next" href="../../safe-guides/coding_practice.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        

        
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        

        

        
        <script src="../../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="../../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        
        <script type="text/javascript" src="../../mermaid.min.js"></script>
        
        <script type="text/javascript" src="../../mermaid-init.js"></script>
        

        

    </body>
</html>
